'use strict';const express=require("express"),app=express(),Post=require("../../models/Post"),Media=require("../../models/Media"),Category=require("../../models/Category"),Testimony=require("../../models/Testimony"),Destination=require("../../models/Destination"),router=express.Router();router.all("/*",(e,c,a)=>{e.app.locals.layout="home";a()});
router.get("/",(e,c)=>{Post.find().then(a=>{Post.find().populate("category").limit(2).then(b=>{Post.find().limit(2).then(d=>{Category.find().then(f=>{Testimony.find().populate("user").then(g=>{Destination.find().then(h=>{Media.find().then(k=>{c.render("home/index",{blog_posts:a,home_blogs:b,sidebar_posts:d,categories:f,testimonies:g,destinations:h,medias:k})}).catch(k=>console.log(k))}).catch(h=>console.log(h))}).catch(g=>console.log(g))}).catch(f=>console.log(f))}).catch(d=>console.log(d))}).catch(b=>
console.log(b))}).catch(a=>console.log(a))});router.get("/blogs",(e,c)=>{Post.find().populate("user").populate("category").then(a=>{c.render("home/blogs",{blog_posts:a})}).catch(a=>console.log(a))});router.get("/contact",(e,c)=>{c.render("home/contact")});router.get("/about",(e,c)=>{Testimony.find().populate("user").then(a=>{Media.find().then(b=>{c.render("home/about",{testimonies:a,medias:b})}).catch(b=>console.log(b))}).catch(a=>console.log(a))});router.get("/services",(e,c)=>{c.render("home/services")});
router.get("/gallery",(e,c)=>{Media.find().then(a=>{c.render("home/gallery",{medias:a})}).catch(a=>console.log(a))});router.get("/single_blog/:id",(e,c)=>{Post.findOne({slug:e.params.id}).populate("user").populate("category").then(a=>{Post.find().limit(4).then(b=>{Category.find().then(d=>{c.render("home/single_blog",{blog:a,sidebar_posts:b,categories:d})}).catch(d=>console.log(d))}).catch(b=>console.log(b))}).catch(a=>console.log(a))});
router.get("/author_blog/:id",(e,c)=>{Post.find({user:e.params.id}).populate("user").populate("category").then(a=>{Post.find().limit(4).then(b=>{Category.find().then(d=>{c.render("home/author_blog",{blog_posts:a,sidebar_posts:b,categories:d})}).catch(d=>console.log(d))}).catch(b=>console.log(b))}).catch(a=>console.log(a))});
router.get("/category_blog/:id",(e,c)=>{Post.find({category:e.params.id}).populate("user").populate("category").then(a=>{Post.find().limit(4).then(b=>{Category.find().then(d=>{c.render("home/category_blog",{blog_posts:a,sidebar_posts:b,categories:d})}).catch(d=>console.log(d))}).catch(b=>console.log(b))}).catch(a=>console.log(a))});module.exports=router;