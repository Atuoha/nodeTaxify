'use strict';const express=require("express"),app=express(),router=express.Router(),Destination=require("../../../models/Destination"),faker=require("faker"),{userAuth}=require("../../../helpers/authenticate");router.all("/*",(b,d,a)=>{b.app.locals.layout="admin";a()});router.get("/",(b,d)=>{Destination.find().then(a=>{d.render("accounts/admin/destination",{destinations:a})}).catch(a=>console.log(a))});
router.post("/create",(b,d)=>{const a=new Destination;a.title=b.body.title;a.date=new Date;a.save().then(c=>{b.flash("success_msg",`${c.title} created successfully :)`);d.redirect("/admin/destinations")}).catch(c=>console.log(c))});
router.post("/dummy",(b,d)=>{for(let a=0;a<b.body.number;a++){const c=new Destination;c.title=faker.lorem.word();c.date=new Date;c.save().then(e=>{b.flash("success_msg",`${b.body.number} dummy destinations successfully created  :)`);d.redirect("/admin/destinations")}).catch(e=>console.log(e))}});
router.put("/:id/update",(b,d)=>{Destination.findOne({_id:b.params.id}).then(a=>{a.title=b.body.title;a.save().then(c=>{b.flash("success_msg",`${c.title} has been updated successfully :)`);d.redirect("/admin/destinations")})}).catch(a=>console.log(a))});router.delete("/:id/delete",(b,d)=>{Destination.findOne({_id:b.params.id}).then(a=>{a.delete().then(c=>{b.flash("success_msg",`${c.title} has been deleted successfully :)`);d.redirect("/admin/destinations")}).catch(c=>console.log(c))}).catch(a=>console.log(a))});
module.exports=router;